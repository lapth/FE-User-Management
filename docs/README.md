#### B·∫°n l√† d√¢n chuy√™n Back End, b·∫°n ch∆∞a bao gi·ªù l√†m Front End hay b·∫°n ƒë√£ t·ª´ng l√†m Front End nh∆∞ng ch·ªâ cho nh·ªØng d·ª± √°n nh·ªè ch·ªâ ch·∫°y v√†i th√°ng, team size 5 ƒë·∫øn 10 ng∆∞·ªùi ...

#### B·∫°n ƒë√£ bao gi·ªù ƒë·∫∑t c√¢u h·ªèi l√†: l√†m Front End ·ªü m·ªôt ƒë·ªôi t·∫ßm 50+ ng∆∞·ªùi, d·ª± √°n ch·∫°y trong v√†i nƒÉm th√¨ ng∆∞·ªùi ta l√†m nh∆∞ th·∫ø n√†o ch∆∞a? ph·∫£i chƒÉng h·ªç ch·ªâ d√πng c√°c tools ƒë∆∞·ª£c cung c·∫•p s·∫µn ƒë·ªÉ generate ra project r·ªìi code v√† code, ... T·∫•t nhi√™n l√† kh√¥ng r·ªìi üòÅüòÅüòÅ

#### OK ·ªü lo·∫°t b√†i vi·∫øt n√†y m√¨nh s·∫Ω tr√¨nh b√†y, th·∫£o lu·∫≠n v·ªÅ quy tr√¨nh ph√°t tri·ªÉn ph·∫ßn m·ªÅm, c√°c skills, c√°ch t∆∞ duy m√† m·ªôt Dev Front End n√™n c√≥ ƒë·ªÉ l√†m t·ªët c√¥ng vi·ªác c·ªßa m√¨nh.


### üìñ Ch√∫ng ta s·∫Ω ƒëi qua t·ª´ng n·ªôi dung sau:
1. Kh·ªüi t·∫°o d·ª± √°n `ReactJS` v·ªõi `Webpack`.
2. Unit Test ·ªü Front End v·ªõi `Karma`
3. Code coverage v·ªõi `Istanbul`
4. ·ª®ng d·ª•ng m·∫´u `User Management`, Build v√† Deploy v·ªõi `Firebase Hosting`
5. Automation Test (AUT) v·ªõi `Puppeteer`.

M·ªôt s·ªë kh√°i ni·ªám b·∫°n n√™n c√≥ tr∆∞·ªõc khi ƒë·ªçc ti·∫øp b√†i vi·∫øt:
- [Single Page Application](https://en.wikipedia.org/wiki/Single-page_application): hay c√≤n g·ªçi l√† SPA, ƒë√¢y l√† m·ªôt kh√°i ni·ªám m·ªõi v·ªÅ ph√°t tri·ªÉn ·ª©ng d·ª•ng web, kh√°c bi·ªát c∆° b·∫£n v·ªõi c√°ch truy·ªÅn th·ªëng tr∆∞·ªõc ƒë√¢y l√† ·ªü trang web SPA b·∫°n s·∫Ω kh√¥ng th·∫•y trang b·ªã load l·∫°i khi th·ª±c hi·ªán m·ªôt thao t√°c n√†o ƒë√≥ nh∆∞ tr∆∞·ªõc kia. Th·ª±c ch·∫•t m·ªçi thao t√°c c·ªßa ng∆∞·ªùi d√πng ƒë∆∞·ª£c th·ª±c hi·ªán ·ªü ph√≠a sau, n·ªôi dung m·ªõi s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã khi c√≥ k·∫øt qu·∫£ tr·∫£ v·ªÅ t·ª´ ph√≠a server.
- [NodeJS](https://en.wikipedia.org/wiki/Node.js): l√† m·ªôt ng√¥n ng·ªØ l·∫≠p tr√¨nh, l√† m√¥i tr∆∞·ªùng ch·∫°y code Javascript ·ªü ph√≠a server.
- [ReactJS](https://en.wikipedia.org/wiki/React_(web_framework)): l√† m·ªôt framework ƒë·ªÉ l√†m ·ª©ng d·ª•ng web d·∫°ng SPA ƒë∆∞·ª£c ph√°t tri·ªÉn b·ªüi Facebook.
- [Create React App](https://reactjs.org/docs/create-a-new-react-app.html): l√† m·ªôt tool ƒë·ªÉ kh·ªüi t·∫°o ·ª©ng d·ª•ng SPA v·ªõi ReactJS cho nh·ªØng b·∫°n m·ªõi l√†m quen v·ªõi ReactJS.
- [Webpack](https://webpack.js.org/): l√† m·ªôt th∆∞ vi·ªán ƒë·ªÉ ƒë√≥ng g√≥i m√£ ngu·ªìn, n√©n m√£ ngu·ªìn, m√£ h√≥a m√£ ngu·ªìn, lazy loading, ... 
- [Babel](https://en.wikipedia.org/wiki/Babel_(transcompiler)): l√† m·ªôt tr√¨nh chuy·ªÉn ƒë·ªïi code t·ª´ ƒë·ªãnh d·∫°ng cao ES6+ v·ªÅ ƒë·ªãnh d·∫°ng th·∫•p h∆°n ƒë·ªÉ cho c√°c tr√¨nh duy·ªát c√≥ th·ªÉ hi·ªÉu v√† th·ª±c thi t·ªët nh·∫•t.

# üå¥ Kh·ªüi t·∫°o d·ª± √°n v·ªõi ReactJS v√† Webpack
Th√¥ng th∆∞·ªùng khi b·∫Øt ƒë·∫ßu m·ªôt d·ª± √°n ReactJS th√¨ b·∫°n nghƒ© ngay ƒë·∫øn c√°c [tools h·ªó tr·ª£ b·∫°n t·∫°o d·ª±](https://reactjs.org/docs/create-a-new-react-app.html#recommended-toolchains/) √°n ngay nh·ªØng b∆∞·ªõc ƒë·∫ßu ti√™n nh∆∞: `create-react-app`,... vi·ªác s·ª≠ d·ª•ng c√¥ng c·ª• n√≥ thu·∫≠n l·ª£i cho ng∆∞·ªùi b·∫Øt ƒë·∫ßu nh∆∞ng kh√¥ng th·ª±c s·ª± c·∫ßn cho c√°c d·ª± √°n l·ªõn.

**∆Øu ƒëi·ªÉm**: N√≥ gi√∫p b·∫°n t·∫°o 1 d·ª± √°n ReactJS r·∫•t nhanh, ch·ªâ m·ªôt d√≤ng l·ªánh l√† xong, n√≥ s·∫Ω ƒë√≥ng g√≥i t·∫•t c·∫£ nh·ªØng th∆∞ vi·ªán m√† tool ƒë√≥ cho l√† c·∫ßn thi·∫øt ƒë·ªÉ gi√∫p b·∫°n b·∫Øt ƒë·∫ßu d·ª± √°n, c≈©ng nh∆∞ cung c·∫•p c√°c scripts ƒë·ªÉ dev, build d·ª± √°n.

**Nh∆∞·ª£c ƒëi·ªÉm**: R·∫•t kh√≥ t√πy bi·∫øn, ph·ª©c t·∫°p v√† c·∫ßn nhi·ªÅu th·ªùi gian ƒë·ªÉ t√πy bi·∫øn. Tool ch·ªâ t·∫°o code cho c·∫•u h√¨nh chung, kh√¥ng cho 1 tr∆∞·ªùng h·ª£p c·ª• th·ªÉ n√†o ƒë√≥, n√™n ƒë·ªÉ l√†m cho d·ª± √°n ch·∫°y ƒë∆∞·ª£c v·ªõi m√¥i tr∆∞·ªùng c√¥ng ty, kh√°ch h√†ng th√¨ ch√∫ng ta c·∫ßn t√πy bi·∫øn nhi·ªÅu th·ª© n·ªØa.

Do ƒë√≥ trong c√°c d·ª± √°n l·ªõn ng∆∞·ªùi ta th∆∞·ªùng x√¢y d·ª±ng t·ª´ ƒë·∫ßu t·∫•t c·∫£ nh·ªØng g√¨ h·ªç c·∫ßn thay v√¨ d·ª±a v√†o m·ªôt tool n√†o ƒë√≥. Ph·∫ßn n√†y m√¨nh s·∫Ω tr√¨nh b√†y c√°ch d·ª±ng d·ª± √°n ReactJS t·ª´ ƒë·∫ßu v·ªõi Webpack, m·ªôt trong nh·ªØng th∆∞ vi·ªán ƒë√¨nh ƒë√°m trong vi·ªác ƒë√≥ng g√≥i m√£ ngu·ªìn ·ªü th·ªùi ƒëi·ªÉm vi·∫øt b√†i n√†y. Ngo√†i Webpack ra th√¨ b·∫°n c≈©ng c√≥ nhi·ªÅu l·ª±a ch·ªçn kh√°c nh∆∞ Browserify, Gulp, Grunt, ... b·∫°n t√¨m hi·ªÉu th√™m n·∫øu mu·ªën.

### Kh·ªüi t·∫°o v√† c√†i ƒë·∫∑t th∆∞ vi·ªán
```sh
# T·∫°o th∆∞ m·ª•c d·ª± √°n, kh·ªüi t·∫°o d·ª± √°n
cd $PROJECT_HOME
mkdir FE-UserManagement
npm init

# C√†i ƒë·∫∑t th∆∞ vi·ªán webpack
# Th∆∞ vi·ªán n√†y gi√∫p b·∫°n ƒë√≥ng g√≥i, m√£ h√≥a, n√©n to√†n b·ªô ·ª©ng d·ª•ng th√†nh 1 / nhi·ªÅu file nh·ªè ƒë·ªÉ deploy l√™n m√¥i tr∆∞·ªùng th·ª±c.
# --save-dev: c√≥ nghƒ©a l√† c√°c th∆∞ vi·ªán n√†y ch·ªâ c√†i ƒë·∫∑t ·ªü m√¥i tr∆∞·ªùng ph√°t tri·ªÉn, m√¥i tr∆∞·ªùng th·ª±c kh√¥ng d√πng ƒë·∫øn, c√°c build tool s·∫Ω d·ª±a
# v√†o ƒë√≥ ƒë·ªÉ bi·∫øt c·∫ßn ƒë√≥ng g√≥i nh·ªØng th∆∞ vi·ªán n√†o.
npm i webpack webpack-cli --save-dev

# C√†i ƒë·∫∑t Babel, b·∫°n c·∫ßn th∆∞ vi·ªán n√†y ƒë·ªÉ chuy·ªÉn c√°c m√£ code ·ªü c√°c phi√™n b·∫£n cao v·ªÅ ES5 v√† bi√™n d·ªãch code ReactJS sang Javascript thu·∫ßn t√∫y.
# L√Ω do ch√∫ng ta c·∫ßn chuy·ªÉn v·ªÅ phi√™n b·∫£n ES5 l√† c√°c tr√¨nh duy·ªát ch∆∞a h·ªó tr·ª£ ƒë·∫ßy ƒë·ªß t√≠nh nƒÉng c·ªßa c√°c phi√™n b·∫£n cao h∆°n.
npm i @babel/core babel-loader @babel/preset-env @babel/preset-react --save-dev

# C√†i ƒë·∫∑t th∆∞ vi·ªán ReactJS
# --save: c√≥ nghƒ©a l√† b·∫°n c·∫ßn th∆∞ vi·ªán n√†y khi ch·∫°y th·ª±c, y√™u c·∫ßu c√°c th∆∞ vi·ªán ƒë√≥ng g√≥i k√®m theo th∆∞ vi·ªán n√†y.
npm i react react-dom -save

# C√†i plugins cho webpack, webpack c√≥ r·∫•t nhi·ªÅu plugins ƒëi c√πng, ƒë√¢y ch·ªâ l√† m·ªôt trong nh·ªØng th·ª© ƒë√≥
npm i html-webpack-plugin --save-dev

# Th∆∞ vi·ªán n√†y d√πng ƒë·ªÉ kh·ªüi t·∫°o server ·ªü local. Server ·ªü ph√≠a m√¥i tr∆∞·ªùng DEV l√† b·∫Øt bu·ªôc trong qu√° tr√¨nh ph√°t tri·ªÉn d·ª± √°n, 
# n√≥ s·∫Ω gi√∫p ch√∫ng ta t·∫°o 1 server t·∫°m nh∆∞ m√¥i tr∆∞·ªùng th·ª±c, deploy code v√† gi√∫p ch√∫ng ta c√≥ th·ªÉ xem ƒë∆∞·ª£c code c·ªßa m√¨nh ho·∫°t 
# ƒë·ªông nh∆∞ th·∫ø n√†o
npm i webpack-dev-server --save-dev

# C√†i c√°c b·ªô loader kh√°c cho webpack ƒë·ªÉ ƒë·ªçc file css, scss, img, html, ... b·∫°n c·∫ßn g√¨ th√¨ c·ª© th√™m v√†o
npm i style-loader css-loader sass-loader node-sass --save-dev
```
Tips:
> ·ªû ƒë√¢y m√¨nh t√°ch ra t·ª´ng l·ªánh ƒë·ªÉ ti·ªán gi·∫£i th√≠ch, b·∫°n c√≥ th·ªÉ gom c√°c th∆∞ vi·ªán v√†o c√πng m·ªôt c√¢u l·ªánh install ƒë·ªÉ ƒë·ª° m·∫•t th·ªùi gian.

OK vi·ªác c√†i ƒë·∫∑t nh∆∞ v·∫≠y l√† t·∫°m ƒë·ªß r·ªìi b√¢y gi·ªù m√¨nh c·∫•u h√¨nh cho n√≥ ch·∫°y nh√©:

#### C·∫•u h√¨nh Babel:
Vi·ªác c·∫•u h√¨nh Babel kh√° ƒë∆°n gi·∫£n, b·∫°n t·∫°o 1 file `.babelrc` ·ªü th∆∞ m·ª•c g·ªëc c·ªßa d·ª± √°n $PROJECT_HOME v·ªõi n·ªôi dung sau
```json
{
    "presets": [
        "@babel/env",
        "@babel/react"
    ]
}
```

#### C·∫•u h√¨nh webpack:
File c·∫•u h√¨nh ch√≠nh c·ªßa webpack l√† `webpack.config.js`, b·∫°n t·∫°o ra file n√†y v√† ƒë·∫∑t ngay th∆∞ m·ª•c $PROJECT_HOME c·ªßa d·ª± √°n v·ªõi n·ªôi dung sau
```javascript
const HtmlWebPackPlugin = require("html-webpack-plugin");
const { CleanWebpackPlugin } = require('clean-webpack-plugin');
const path = require('path');

module.exports = {
    // ƒêi·ªÉm b·∫Øt ƒë·∫ßu ƒë·ªÉ webpack ph√¢n t√≠ch th∆∞ vi·ªán, code, ... c·ªßa d·ª± √°n
    entry: "./src/index.js",
  
    // C√†i ƒë·∫∑t ƒë·∫ßu ra c·ªßa d·ª± √°n khi ch·∫°y build
    output: {
        path: path.resolve(__dirname, './dist'),
        filename: 'bundle.js'
    },

    // test h·ªó tr·ª£ regex ƒë·ªÉ b·∫°n vi·∫øt query
    module: {
        rules: [
            // C√†i ƒë·∫∑t n√†y nghƒ©a l√† s·∫Ω d√πng th∆∞ vi·ªán babel-loader ƒë·ªÉ ƒë·ªçc c√°c file js v√† jsx
            {
                test: /\.(js|jsx)$/i,
                exclude: /node_modules/,
                use: {
                    loader: "babel-loader"
                }
            },
            
            // C√°c file css v√† scss th√¨ d√πng css-loader v√† sass-loader
            {
                test: /\.(css|s[ac]ss)$/i, 
                use: [
                    'style-loader',
                    {
                        loader: "css-loader",
                        options: {
                            modules: true
                        }
                    },
                    {
                        loader: 'sass-loader',
                        options: {
                          implementation: require('node-sass'),
                        },
                    }
                ]
            },
            
            // C√°c file html th√¨ d√πng html-loader
            {
                test: /\.html$/,
                use: [
                    {
                        loader: "html-loader"
                    }
                ]
            }
        ]
    },

    // Khai b√°o c√°c plugins cho webpack bi·∫øt
    plugins: [
        new CleanWebpackPlugin(),
        new HtmlWebPackPlugin({
            template: "./src/index.html",
            filename: "./index.html"
        })
    ]
};
```

#### Th√™m scripts v√†o `package.json`
```json
"scripts": {
    "start": "webpack-dev-server --mode development",
    "build": "webpack --mode production"
}
```
- `start`: D√πng ƒë·ªÉ ch·∫°y server ph√≠a local, n√≥ s·∫Ω t·ª± ƒë·ªông bi√™n d·ªãch, deploy m√£ ngu·ªìn v√† server t·∫°m cho b·∫°n ki·ªÉm th·ª≠
- `build`: D√πng ƒë·ªÉ ƒë√≥ng g√≥i d·ª± √°n ch·∫°y ·ªü m√¥i tr∆∞·ªùng th·ª±c, c√°c file s·∫Ω ƒë∆∞·ª£c m√£ h√≥a, n√©n, ... b·ªüi webpack

OK v·ªÅ c·∫•u h√¨nh b·∫°n c·∫ßn v·∫≠y l√† ƒë·ªß, b·∫°n th·ª≠ t·∫°o ra m·ªôt file `src/index.js` r·ªìi ch·∫°y th·ª≠ xem n√≥ ho·∫°t ƒë·ªông th·∫ø n√†o nh√©, ho·∫∑c b·∫°n c√≥ th·ªÉ clone b√†i m·∫´u ·ªü ƒë√¢y
```
cd $PROJECT_HOME

# L·ªánh n√†y s·∫Ω checkout duy nh·∫•t branch InitWebpack 
git clone --single-branch --branch InitWebpack https://github.com/lapth/FE-User-Management.git

cd FE-User-Management
```

#### Ch·∫°y th·ª≠ ·ªü local
```sh
npm run start
```
Sau khi ch·∫°y server xong b·∫°n b·∫≠t browser ·ªü ƒë·ªãa ch·ªâ [http://localhost:8080/](http://localhost:8080/) ƒë·ªÉ xem k·∫øt qu·∫£, n√≥ nh∆∞ th·∫ø n√†y
![](https://usermanagement-sample.firebaseapp.com/images/InitProject_Local_UI.png)

**Tips**
> N·∫øu b·∫°n mu·ªën t·ª± b·∫≠t Browser th√¨ th√™m tham s·ªë `--open`
> N·∫øu b·∫°n mu·ªën ch·ªâ rebuild nh·ªØng module ƒë∆∞·ª£c thay ƒë·ªïi th√¥i th√¨ th√™m tham s·ªë `--hot`

#### Build ·ª©ng d·ª•ng
```sh
npm run build
```
C√°c file output s·∫Ω ƒë∆∞·ª£c t·∫°o ra trong th∆∞ m·ª•c `dist`, n√≥ nh∆∞ th·∫ø n√†y:
![](https://usermanagement-sample.firebaseapp.com/images/InitProject_Local_Build.png)

ü§†ü§†ü§† OK qu√° tr√¨nh kh·ªüi t·∫°o d·ª± √°n v·ªõi webpack t·∫°m th·ªùi ho√†n th√†nh ü§†ü§†ü§†

# üå¥ Unit Test ·ªü Front End v·ªõi Karma
L·∫°i l√† Unit Test üòÇüòÇüòÇ, m√¨nh gi√°m ch·∫Øc h∆°n 50% b·∫°n ƒë·ªçc b√†i n√†y ƒë·ªÅu gh√©t cay gh√©t ƒë·∫Øng UT. M√¨nh c≈©ng t·ª´ng nh∆∞ v·∫≠y, nh·ªØng nƒÉm ƒë·∫ßu ƒë·ªùi ngh·ªÅ l√†m Dev m√¨nh c≈©ng r·∫•t gh√©t UT, sau v√†i nƒÉm th√¨ kh√¥ng c√≤n gh√©t n·ªØa v√¨ n√≥ l√† vi·ªác ph·∫£i l√†m ü§£ü§£ü§£.

UT l√† vi·ªác ki·ªÉm th·ª≠ code ƒë√£ vi·∫øt ra ·ªü giai ƒëo·∫°n ph√°t tri·ªÉn, n√≥ c√≥ th·ªÉ vi·∫øt tr∆∞·ªõc, vi·∫øt sau hay c√πng vi·∫øt v·ªõi code ch√≠nh c·ªßa m·ªôt ch·ª©c nƒÉng n√†o ƒë√≥, n√≥ t√πy thu·ªôc v√†o d·ª± √°n b·∫°n ƒëang l√†m ch·ªçn ph∆∞∆°ng √°n n√†o.

**M·ªôt s·ªë kh√°i ni·ªám v·ªÅ UT:**
- [Unit Test](https://en.wikipedia.org/wiki/Unit_testing): Kh√°i ni·ªám c∆° b·∫£n v·ªÅ Unit Test
- [Unit Testing Tutorial: What is, Types, Tools, EXAMPLE](https://www.guru99.com/unit-testing-guide.html) C√°c kh√°i ni·ªám kh√°c li√™n quan ƒë·∫øn test m·ªôt s·∫£n ph·∫©m.
- [Mocha](https://mochajs.org/): L√† 1 test framework, t√≠ch h·ª£p t·ªët v·ªõi NodeJS v√† c·∫£ Browser. ƒê·∫∑c ƒëi·ªÉm c·ªßa Framework n√†y l√† cho ph√©p b·∫°n t√πy bi·∫øn c√°c c√¥ng c·ª• li√™n quan nh∆∞ mocking, assertion, ... d·ªÖ d√†ng.
- [Chai](https://www.chaijs.com/): Th∆∞ vi·ªán h·ªó tr·ª£ t·∫°o c√°c assertion khi vi·∫øt test case.
- Spy, Stub, Mock: L√† c√°c c√°ch ƒë·ªÉ t·∫°o d·ªØ li·ªáu ·∫£o, h√†m ·∫£o, service, ... ·∫£o cho ƒë·∫ßu v√†o c·ªßa 1 test case, c√°c b·∫°n ƒë·ªçc th√™m [Sinon](https://sinonjs.org/)
- [Jest](https://jestjs.io/): C≈©ng l√† test framework ƒë∆∞·ª£c cung c·∫•p b·ªüi Facebook. Jest t√≠ch h·ª£p kh√° nhi·ªÅu cung c·ª• cho vi·ªác vi·∫øt Unit Test, v·ªõi Jest th√¨ b·∫°n kh√¥ng c·∫ßn c√†i ƒë·∫∑t th√™m g√¨ nhi·ªÅu. Th√¥ng th∆∞·ªùng b·∫°n ch·ªâ c·∫ßn ch·ªçn Jest ho·∫∑c b·ªô 3 Mocha, Chai, Sinon l√† ƒë·ªß cho vi·ªác vi·∫øt UT.
- [Enzyme](https://enzymejs.github.io/enzyme/): B·ªô c√¥ng c·ª• kh√° t·ªët ƒë·ªÉ vi·∫øt UT cho React Component.
- [JSDom](https://github.com/jsdom/jsdom/blob/master/README.md): L√† b·ªô m√¥ ph·ªèng tr√¨nh duy·ªát th·ª±c nh∆∞ Chrome, Firefox, ... v·ªõi nhi·ªÅu h·∫°n ch·∫ø v·ªÅ ch·ª©c nƒÉng. ∆Øu ƒëi·ªÉm c·ªßa n√≥ l√† nhanh h∆°n tr√¨nh duy·ªát th·ª±c. C√°c testing framework ·ªü ph√≠a FrontEnd th∆∞·ªùng t√≠ch h·ª£p v·ªõi th∆∞ vi·ªán n√†y cho vi·ªác ch·∫°y test cases.
- [Karma](http://karma-runner.github.io/4.0/intro/how-it-works.html): Test Runner, h·ªó tr·ª£ ch·∫°y UT tr√™n nhi·ªÅu Browser TH·ª∞C kh√°c nhau, report, debug, ...

**N·∫øu b·∫°n ƒë·ªçc h·∫øt c√°c link tr√™n th√¨ qu√° ƒë·ªß ƒë·ªÉ hi·ªÉu UT r·ªìi ƒë√≥, c√≤n ƒë√¢y l√† kh√°i ni·ªám c·ªßa m√¨nh v·ªÅ UT:**
- N√≥ l√† 1 ƒëo·∫°n code ƒë·ªÉ test c√°c ch·ª©c nƒÉng m√¨nh ƒë√£ l√†m ra.
> V√≠ d·ª•: b·∫°n vi·∫øt 1 h√†m ƒë·ªÉ in ch·ªØ "Hello World", l√†m sao b·∫°n gi√°m ch·∫Øc h√†m ƒë√≥ ch·∫°y ƒë√∫ng m√† kh√¥ng ph·∫£i ch·∫°y th·ª≠ ·ª©ng d·ª•ng ƒë·ªÉ ki·ªÉm tra? Vi·∫øt UT l√† m·ªôt trong c√°c c√°ch b·∫°n c√≥ th·ªÉ l√†m.
- UT ƒë·ªÉ ƒë·∫£m b·∫£o code c·ªßa m√¨nh ch·∫°y ƒë√∫ng nh∆∞ m√¨nh mong mu·ªën tr∆∞·ªõc khi chuy·ªÉn qua c√°c giai ƒëo·∫°n kh√°c nh∆∞ Manual test, Deployment, ... th∆∞·ªùng s·∫Ω t·ªën r·∫•t nhi·ªÅu th·ªùi gian ƒë·ªÉ s·ª≠a l·ªói m√† b·∫°n ƒë√£ t·∫°o ra so v·ªõi UT.
> V√≠ d·ª•:
>
> D·ª± √°n c·ªßa b·∫°n c√≥ 2 c√¥ng ƒëo·∫°n l√† Code + UT v√† Manual Test (ƒë∆∞·ª£c th·ª±c hi·ªán b·ªü ƒë·ªôi Tester).
>
> Gi·∫£ s·ª≠ b·∫°n code 1 h√†m A(), b·∫°n vi·∫øt UT kh√¥ng c·∫©n th·∫≠n ƒë·ªÉ ph√°t hi·ªán h·∫øt c√°c l·ªói c·∫ßn thi·∫øt.
>
> ƒê·∫øn c√¥ng ƒëo·∫°n Manual Test, b·∫°n Tester ph√°t hi·ªán ra, report bug ƒë√≥ l√™n h·ªá th·ªëng, c√°c PO, PM v√†o xem v√† ƒë√°nh gi√°, assign l·∫°i cho b·∫°n hay ai ƒë√≥ kh√°c ƒë·ªÉ fix.
>
> üò± D·ª± √°n c·∫ßn r·∫•t nhi·ªÅu c√¥ng s·ª©c ƒë·ªÉ gi·∫£i quy·∫øt bug ƒë√≥ so v·ªõi th·ªùi ƒëi·ªÉm vi·∫øt UT.

- UT l√† ƒë·ªÉ m·ªôt ng∆∞·ªùi n√†o ƒë√≥ sau v√†i nƒÉm khi v√†o b·∫£o tr√¨ (maintain) s·∫£n ph·∫©m c·ªßa b·∫°n, d√π kh√¥ng hi·ªÉu h·∫øt c√°c ch·ª©c nƒÉng b·∫°n ƒë√£ vi·∫øt l√† g√¨, nh∆∞ng v·∫´n gi√°m ch·∫Øc ch·ª©c nƒÉng m·ªõi m√† ng∆∞·ªùi ƒë√≥ vi·∫øt kh√¥ng l√†m h·ªèng c√°c ch·ª©c nƒÉng m√† b·∫°n vi·∫øt.

- UT l√† ƒë·ªÉ ki·ªÉm th·ª≠ c√°c tr∆∞·ªùng h·ª£p r·∫•t kh√≥ ph√°t hi·ªán ·ªü m√¥i tr∆∞·ªùng th·ª±c. V·ªõi UT b·∫°n c√≥ th·ªÉ t·∫°o nh·ªØng code gi·∫£, d·ªØ li·ªáu gi·∫£ ƒë·ªÉ ki·ªÉm th·ª≠ c√°c ch·ª©c nƒÉng nh∆∞ v·∫≠y thay v√¨ ƒë·ª£i d·ªØ li·ªáu th·ª±c ƒë·ªÉ xem n√≥ ho·∫°t ƒë·ªông th·∫ø n√†o.
> V√≠ d·ª•:
>
> ·ª®ng d·ª•ng b·∫°n c√≥ 1 ch·ª©c nƒÉng l√† c·ª© sau 24 gi·ªù c√°c th√¥ng s·ªë s·∫Ω ƒë∆∞·ª£c thi·∫øt l·∫≠p l·∫°i th√†nh c√°c gi√° tr·ªã m·∫∑c ƒë·ªãnh.
>
> Trong tr∆∞·ªùng h·ª£p nh∆∞ v·∫≠y ƒë·ªÉ bi·∫øt ·ª©ng d·ª•ng ch·∫°y ƒë√∫ng hay kh√¥ng trong m√¥i tr∆∞·ªùng th·ª±c kh√° l√† m·∫•t th·ªùi gian, tuy nhi√™n vi·ªác ƒë√≥ kh√° ƒë∆°n gi·∫£n v·ªõi UT.

- ƒê·ªÉ c√£i l·∫°i v·ªõi Dev kh√°c, code m√¨nh l√†m ra ho√†n to√†n ƒë√∫ng nh∆∞ k·ªãch b·∫£n üòò.
> V√≠ d·ª•:
> 
> D·ª± √°n b·∫°n c√≥ 1 ch·ª©c nƒÉng ƒë∆∞·ª£c ph√°t tri·ªÉn b·ªüi 3 ng∆∞·ªùi c√πng l√∫c v·ªõi 3 h√†m kh√°c nhau. 
>
>- Func 1 l√† l·∫•y th√¥ng tin ƒë·∫ßu v√†o
>- Func 2 l√† x·ª≠ l√Ω logic c·ªßa th√¥ng tin ƒë·∫ßu v√†o
>- Func 3 l√† l∆∞u th√¥ng tin ƒë√≥ v√†o DB
>
> ·ªû ƒë√¢y b·∫°n th·∫•y s·ª± ph·ª• thu·ªôc c·ªßa 3 h√†m n√†y v·ªõi nhau. Nh∆∞ v·∫≠y l√†m sao b·∫°n ph√°t tri·ªÉn ƒë∆∞·ª£c Func 2 t·ªët m√† kh√¥ng b·ªã ·∫£nh h∆∞·ªüng b·ªüi ti·∫øn ƒë·ªô c≈©ng nh∆∞ output c·ªßa Func 1? UT l√† m·ªôt trong c√°c c√°ch b·∫°n c√≥ th·ªÉ l√†m ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ ƒë√≥, b·∫°n c√≥ th·ªÉ gi·∫£ d·ªØ li·ªáu c·ªßa Func 1 ƒë·ªÉ ki·ªÉm th·ª≠ Func 2 m√¨nh ƒëang l√†m ƒë·ªÉ ƒë·∫£m b·∫£o Func 2 ch·∫°y ƒë√∫ng nh∆∞ mong mu·ªën.

- V√† c√≤n r·∫•t nhi·ªÅu tr∆∞·ªùng h·ª£p b·∫°n c√≥ th·ªÉ gi·∫£i quy·∫øt v·ªõi UT nh∆∞ng UT n√≥ c√≥ **nh∆∞·ª£c ƒëi·ªÉm l√† n√≥ s·∫Ω m·∫•t th√™m kho·∫£ng t·ª´ 10% -> 25% th·ªùi gian l√†m 1 task**, n√™n khi estimate b·∫°n n√™n nh·ªõ c·ªông con s·ªë n√†y v√†o ƒë·ªÉ tr√°nh OT, ON nh√© üòÇüòÇüòÇ


**T·∫°i sao l√† "Unit Test ·ªü Front End v·ªõi Karma"**

1. B·∫°n c·∫ßn bi·∫øt r·∫±ng: web application l√† ·ª©ng d·ª•ng ƒë∆∞·ª£c ch·∫°y d·ª±a tr√™n c√°c tr√¨nh duy·ªát v√† b·∫£n th√¢n ·ª©ng d·ª•ng ƒë√≥ ch·ª©a r·∫•t nhi·ªÅu code m√† ch·ªâ c√≥ tr√¨nh duy·ªát m·ªõi hi·ªÉu. Do ƒë√≥ vi·ªác ch·∫°y UT b·∫°n c≈©ng ph·∫£i d·ª±a v√†o c√°c tr√¨nh duy·ªát ƒë·ªÉ ch·∫°y ch·ª© kh√¥ng ph·∫£i ch·ªâ d·ª±a v√†o Framework nh∆∞ vi·ªác vi·∫øt UT ·ªü ph√≠a BackEnd ƒë∆∞·ª£c.

2. C√°c UT Framework (UT-F) ·ªü ph√≠a FrontEnd th√¥ng th∆∞·ªùng kh√¥ng m·∫∑c ƒë·ªãnh t√≠ch h·ª£p vi·ªác ch·∫°y UT tr√™n b·∫•t k·ª≥ tr√¨nh duy·ªát n√†o, m√† l√† JSDom. Vi·ªác c·∫•u h√¨nh ƒë·ªÉ UT-F ch·∫°y v·ªõi c√°c tr√¨nh duy·ªát kh√°c nhau l√† ho√†n to√†n c√≥ th·ªÉ, tuy nhi√™n n√≥ kh√¥ng d·ªÖ d√†ng ch√∫t n√†o üòÇüòÇüòÇ, do ƒë√≥ m√¨nh gi·ªõi thi·ªáu ƒë·∫øn c√°c b·∫°n th∆∞ vi·ªán Karma, m·ªôt th∆∞ vi·ªán kh√° m·∫°nh cho vi·ªác ch·∫°y UT v·ªõi c√°c tr√¨nh duy·ªát kh√°c nhau, report k·∫øt qu·∫£ UT v√† h·ªó tr·ª£ debug code c·ªßa UT.

#### C√†i ƒë·∫∑t Unit Test v·ªõi Karma
##### C√†i UT Framework
```
npm i mocha chai --save-dev
```
> UT-F s·∫Ω h·ªó tr·ª£ ch√∫ng ta trong qu√° tr√¨nh vi·∫øt UT, n·∫øu b·∫°n th√≠ch UT-F n√†o kh√°c th√¨ c√°c b·∫°n c√≥ th·ªÉ ch·ªçn n√≥.

##### C√†i c√°c th∆∞ vi·ªán Karma
```
npm i karma karma-chrome-launcher karma-firefox-launcher karma-cli karma-mocha karma-sourcemap-loader karma-webpack puppeteer --save-dev
```
- `Karma`, `Karma-cli`: Th∆∞ vi·ªán ch√≠nh c·ªßa Karma

- `*-laucher`: Gi√∫p ch√∫ng ta c√≥ th·ªÉ ch·∫°y UT ƒë∆∞·ª£c tr√™n c√°c Browser t∆∞∆°ng ·ª©ng nh∆∞ Chrome, Firefox, ...

- `puppeteer`: B·ªô Chromium ph√°t tri·ªÉn b·ªüi Google, ch√∫ng ta s·∫Ω n√≥i nhi·ªÅu h∆°n ·ªü ph·∫ßn `Automation Test`.

#### C·∫•u h√¨nh d·ª± √°n
- B·∫°n th√™m d√≤ng n√†y v√†o `webpack.config.js` ƒë·ªÉ c√≥ th·ªÉ th·∫•y source code g·ªëc khi debug ·ªü m√¥i tr∆∞·ªùng DEV. B·∫°n xem th√™m t√†i li·ªáu [Devtool](https://webpack.js.org/configuration/devtool/) cho c√°c tham s·ªë.
```javascript
module.exports = {
    devtool: 'inline-source-map',
}
```

- B·∫°n th√™m m·ªõi file `karma.conf.js` ·ªü th∆∞ m·ª•c g·ªëc c·ªßa d·ª± √°n $PROJECT_HOME, ƒë√¢y l√† file c·∫•u h√¨nh ch√≠nh ƒë·ªÉ ch·∫°y Karma

```javascript
// L·∫•y l·∫°i c·∫•u h√¨nh webpack thay v√¨ vi·∫øt m·ªõi
var webpackConfig = require('./webpack.config.js');

// Puppeteer c·∫ßn tham s·ªë n√†y ƒë·ªÉ ch·∫°y
process.env.CHROME_BIN = require('puppeteer').executablePath()

// C·∫•u h√¨nh Karma
module.exports = function (config) {
    config.set({
        // Framework s·ª≠ d·ª•ng ·ªü b√†i n√†y l√† mocha, n·∫øu b·∫°n s·ª≠ d·ª•ng fw kh√°c, c√≥ th·ªÉ th√™m v√†o
        frameworks: ['mocha'],

        port: 9876, // Port ch·∫°y debug
        colors: true,
        logLevel: config.LOG_INFO,
        autoWatch: false, // True nghƒ©a l√† t·ª± l·∫Øng nghe c√°c file thay ƒë·ªïi ƒë·ªÉ ch·∫°y l·∫°i
        // browsers: ['Chrome', 'Firefox'],
        // B·∫°n mu·ªën hi·ªÉu Headless l√† g√¨ th√¨ c√≥ th·ªÉ ƒë·ªçc ·ªü ƒë√¢y: https://developers.google.com/web/updates/2017/04/headless-chrome
        browsers: ['ChromeHeadless', 'FirefoxHeadless'],
        singleRun: false, // Ch·∫°y m·ªôt l·∫ßn r·ªìi tho√°t lu√¥n hay ch·ªù thay ƒë·ªïi ƒë·ªÉ ch·∫°y l·∫°i. ·ªû mode PRO b·∫°n c·∫ßn ƒë·∫∑t n√≥ l√† true
        autoWatchBatchDelay: 300,
        
        // Danh s√°ch c√°c file ƒë∆∞·ª£c load v√†o Browser trong qu√° tr√¨nh ch·∫°y test
        // B·∫°n xem t√†i li·ªáu http://karma-runner.github.io/4.0/config/configuration-file.html ph·∫ßn File Patterns ƒë·ªÉ bi·∫øt c√∫ ph√°p t√¨m files
        files: [
            'test/suites/test-suite.js',
            // 'test/**/*-Test.js',
		],

        // Ti·ªÅn x·ª≠ l√Ω tr∆∞·ªõc khi ch·∫°y
        preprocessors: {
            'test/suites/test-suite.js': ['webpack', 'sourcemap']
            // 'test/**/*-Test.js': ['webpack', 'sourcemap']
        },
        reporters: ['dots'],
        
        // C·∫•u h√¨nh webpack
        webpack: webpackConfig,
        webpackServer: {
            noInfo: true
        }
    });
};
```

- Th√™m scripts v√†o `package.json`
```json
"scripts": {
    "test": "karma start",
    "test-normal": "mocha --require @babel/register --exit test/**/*-Test.js"
  }
```
- `test`: ƒê·ªÉ ch·∫°y UT v·ªõi Karma
- `test-normal`: ƒê·ªÉ ch·∫°y UT thu·∫ßn v·ªõi m√¥i tr∆∞·ªùng Node, ko t·∫£i UT l√™n b·∫•t k·ª≥ tr√¨nh duy·ªát n√†o. H·∫ßu h·∫øt test cases s·∫Ω l·ªói.

#### Chu·∫©n b·ªã source code
B·∫°n c√≥ th·ªÉ l·∫•y source t·ª´ ƒë√¢y ƒë·ªÉ tr·∫£i nghi·ªám
```
cd $PROJECT_HOME

# L·ªánh n√†y s·∫Ω checkout duy nh·∫•t branch InitUnitTest 
git clone --single-branch --branch InitUnitTest https://github.com/lapth/FE-User-Management.git

cd FE-User-Management

npm install
```

#### Ch·∫°y test v·ªõi Karma
```
npm run test
```
K·∫øt qu·∫£ ch·∫°y c·ªßa b·∫°n tr√¥ng n√≥ nh∆∞ th·∫ø n√†y
![](https://usermanagement-sample.firebaseapp.com/images/InitUnitTest_Test_OK_Result.png)


#### Ch·∫°y test thu·∫ßn
```
npm run test-normal
```
C·∫•u h√¨nh n√†y ƒë·ªÉ ch·ª©ng minh ph√≠a FrontEnd, UT c·∫ßn d·ª±a v√†o Browser ƒë·ªÉ ch·∫°y.

K·∫øt qu·∫£ ch·∫°y n√≥ tr√¥ng nh∆∞ th·∫ø n√†y
![](https://usermanagement-sample.firebaseapp.com/images/InitUnitTest_Test_KO_Result.png)

#### Debug
B·∫°n c·∫ßn ch·ªânh l·∫°i tham s·ªë ·ªü file `karma.conf.js`
```json
autoWatch: true,
singleRun: false
```
Sau ƒë√≥ b·∫°n ch·∫°y test v·ªõi Karma nh∆∞ b√¨nh th∆∞∆°ng. Sau khi ch·∫°y v·ªõi Karma xong:
1. B·∫°n b·∫≠t Browser l√™n v√†o ƒë·ªãa ch·ªâ: http://localhost:9876/debug.html
2. `F12/Inspect` ƒë·ªÉ v√†o DEV mode c·ªßa Browser.
3. `^ + P`: ƒêi·ªÅn t√™n file UT mu·ªën debug v√†o
4. ƒê·∫∑t Breakpoints d√≤ng mu·ªën debug
5. Refresh ƒë·ªÉ ch·∫°y l·∫°i UT

M√†n h√¨nh debug c·ªßa b·∫°n tr√¥ng nh∆∞ sau:
![](https://usermanagement-sample.firebaseapp.com/images/InitUnitTest_Test_Debug.png)

#### T·∫°m k·∫øt
V·∫≠y l√† b·∫°n ƒë√£ quen thu·ªôc v·ªõi UT r·ªìi heng, hy v·ªçng sau khi ƒë·ªçc b√†i vi·∫øt n√†y b·∫°n kh√¥ng c√≤n c·∫£m th·∫•y kh√≥ ch·ªãu khi vi·∫øt UT n·ªØa. Ch√∫c c√°c b·∫°n th√†nh c√¥ng!

